import"./esm-chunk-d9927197.js";import{EnsureElement as e,AttachEventToElement as t,elementIsInDOM as o,DetachEventFromElement as n}from"./esm-dom-utils-039553e2.js";import{D as a,T as r,R as u}from"./esm-chunk-5bc3348b.js";import{OnOutsideClick as s,IsDropDownVisible as i}from"./esm-dropdowns-ac548de9.js";import"./esm-chunk-5ae0b2a0.js";import{K as c,S as d,H as m,G as l}from"./esm-chunk-79b76668.js";function f(e){return e==c.Tab||16<=e&&e<=20}var v=200,y=v/2;function k(e){var t=I(e);d(t)}function p(t){t=e(t),document.activeElement===t&&(C(t),g(t))}function C(e){e&&!e.readOnly&&e.dataset.nullText&&e.value===e.dataset.nullText&&(e.value="")}function w(e,t){e.dataset.timerId&&(clearTimeout(e.dataset.timerId),delete e.dataset.timerId),t||window.setTimeout(function(){w(e,!0)},y)}function g(e){e&&e.dataset.focusedClass&&(e.className=e.dataset.focusedClass)}function T(e,t){return t&&!function(e){f(e.keyCode)||(e.target.dataset.previousValue=e.target.value)}(e),function(e){return h(e)}(e)&&(e.stopPropagation(),e.preventDefault()),!1}function b(e,t,o,n){var a=!1;if(n&&(a=a||function(e){if(f(e.keyCode))return!1;var t=e.target;return!(t&&t.dataset.previousValue===e.target.value)}(e)),a=a||function(e){var t=e.altKey&&(e.keyCode==c.Down||e.keyCode==c.Up),o=h(e),n=e.keyCode==c.Esc||e.keyCode==c.Enter;return t||o||n}(e)){var r=e.target.value;if(o&&m(o)){var u=l(o,!1);t.invokeMethodAsync("OnComboBoxListBoxKeyUp",r,e.keyCode,e.altKey,e.ctrlKey,u.itemHeight,u.scrollTopForRequest,u.scrollHeightForRequest)}else t.invokeMethodAsync("OnComboBoxKeyUp",r,e.keyCode,e.altKey,e.ctrlKey)}}function h(e){return e.keyCode===c.Down||e.keyCode===c.Up||e.keyCode===c.PageUp||e.keyCode===c.PageDown||e.ctrlKey&&(e.keyCode===c.Home||e.keyCode===c.End)}function D(e,t,o){if(t){var n=(new Date).getTime();t.dataset.lastLostFocusTime&&n-t.dataset.lastLostFocusTime<v+100&&!o||(t.dataset.lastLostFocusTime=(new Date).getTime(),e.invokeMethodAsync("OnComboBoxLostFocus",t.value))}}function I(t){return(t=e(t)).querySelector("div.dxbs-dm.dropdown-menu")}function x(c,d,m,l,f){if(c=e(c)){a(c),l="true"===l.toLowerCase(),f="true"===f.toLowerCase(),d=e(d);var y=I(c),p=y;f&&k(c);var h=function(e){return T(e,l)},x=function(e){return b(e,m,p,l)},K=function(e){return function(e,t){var o=e.target;C(o),g(o)}(e)},E=function(e){return function(e,t){var o=e.target;w(o,!0),o.dataset.timerId=window.setTimeout(function(){if(delete o.dataset.timerId,function(e){e&&e.dataset.bluredClass&&(e.className=e.dataset.bluredClass)}(o),document.activeElement!==o)try{D(t,o)}catch(e){}},v)}(e,m)},F=function(e){return w(d)},L=function(e){return s(e,c,function(){o(c)||a(c);var e=document.activeElement===d,t=d.dataset.timerId>0,n=y&&i(y);w(d),(e||t||n)&&D(m,d,!0)})};return t(d,"keydown",h),t(d,"keyup",x),t(d,"focus",K),t(d,"blur",E),t(c,"mousedown",F),t(document,r.touchMouseDownEventName,L),u(c,function(){n(d,"keydown",h),n(d,"keyup",x),n(d,"focus",K),n(d,"blur",E),n(c,"mousedown",F),n(document,r.touchMouseDownEventName,L)}),Promise.resolve("ok")}}function K(t){if(t=e(t))return a(t),Promise.resolve("ok")}const E={Init:x,Dispose:K,PrepareInputIfFocused:p,ScrollToSelectedItem:k};export default E;export{K as Dispose,x as Init,p as PrepareInputIfFocused,k as ScrollToSelectedItem};
